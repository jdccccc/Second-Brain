---
title: 组合逻辑设计
categories: 
  - Theory
  - 数字电路与逻辑设计
  - 《数字设计和计算机体系结构》
tags:
  - 数字电路
  - 计算机系统结构
---

# 引言

在数字电路中，电路是一个可以处理离散值变量的网络，一个电路可以看作一个黑盒子。

![image-20220611154923041](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111549101.png)

电路由结点和元件组成。

元件（element）本身又是一个带有输入、输出、功能规范、时序规范的电路。

结点（node）是一段导线，通过电压传递离散值变量。

结点可分为：

- 输入结点
- 输出结点
- 内部结点

数字电路可以分为组合电路和时序电路：

- 组合电路——输出仅仅取决于输入的值
- 时序电路——输出取决于当前输入值和之前的输入值——取决于输入的序列

组合电路的功能规范表示当前各种输入值的输出值。

组合电路的时序规范包括从输入到输出延迟的最大值和最小值。

![image-20220611155922732](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111559770.png)

![](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111600718.png)

组合电路的构成规则：

（当一个电路由相互连接的电路元件构成，则在满足以下条件时，它就是组合电路）

- 每一个电路元件本身都是组合电路
- 每一个电路结点或者是一个电路的输入，或者是连接到外部电路的一个输出端（不能连接到多个外部电路的输出端）
- 电路不包含回路——经过电路的每一条路径最多只能经过每个电路结点一次



组合电路的功能规范通常描述为真值表或布尔表达式。



# 布尔表达式

## 术语

- 变量的真值形式——$A$

- 变量的取反形式——$\bar A$
- 项（literal）——变量或它的反
- 乘积项（product）或蕴含项（implicant）——一项或多项的AND
- 最小项（minterm）——一个包含全部输入变量的乘积项
- 求和项（sum）——一项或者多项的OR
- 最大项（maxterm）——包括了全部输入项的和
- 优先级——NOT>AND>OR

## 与或式

- 有N个输入的真值表包含$2^N$行，每一行对应输入变量的一种可能取值
- 真值表中的每一行都与一个为TRUE的最小项相关联
- 可以用输出Y为TRUE的所有最小项之和的形式写出任意一个真值表的布尔表达式

这种形式是由多个积的和构成，所以称它为函数的与或式范式

![image-20220611163711981](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111637012.png)

![image-20220611163725484](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111637511.png)



## 或与式

- 真值表的每一行对应为FALSE的一个最大项
- 可以直接将真值表中每一个输出为FALSE的最大项相与而得到电路的布尔表达式



<!--当真值表中只有少数行输出为TRUE时，与或式可以产生较短的等式。当真值表中只有少数行为FALSE时，或与式比较简单-->



# 布尔代数

使用布尔代数来化简布尔表达式

![image-20220611164658994](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111646027.png)

布尔代数的公理和定理都符合**对偶原理**：
如果符号0和1互换，操作符AND和OR互换，表达式将依然正确。

我们用上标(')来表示对偶式

## 公理

这5个公理和它们的对偶式定义了布尔变量以及非、或、与的含义。



## 单变量定理



![image-20220611165503093](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111655136.png)

![image-20220611165829337](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111658367.png)

![image-20220611165701528](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111657562.png)

![image-20220611165816799](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111658827.png)

![image-20220611170046753](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111700785.png)



## 多变量定理

![image-20220611170333521](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111703568.png)

- Commutativity和Associativity和传统结合律相同
- Distributivity在$T8'$中OR+的分配高于AND×
- Covering、Combining、Consensus允许消除冗余变量

![image-20220611171111844](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206111711873.png)

逆变器也可称为气泡（bubble）。

- Pushing bubbles backward (from the output) or forward (from the inputs) changes the body of the gate from AND to OR or vice versa.

- Pushing a bubble from the output back to the inputs puts bubbles on all gate inputs.

- Pushing bubbles on all gate inputs forward toward the output puts a bubble on the output.



## 定理的统一证明方法

**完全归纳法**——只要证明针对变量的所有可能值，定理都是正确的



## 等式化简

**化简与或式**的基本原则是使用关系$PA+P\bar A=P$来合并项

**最小与或式**——使用了最少蕴含项的等式

对于具有相同数量的蕴含式的等式，具有最少项数的与或式是最小与或式

**主蕴含项**——不能与其他蕴含项合并生成具有较少项的形式

最小等式中的蕴含项必须都是主蕴含项。

可以使用**重叠定理**复制多个我们想要的项



<!--使用布尔代数定理化简布尔表达式可能带来很多错误，可以使用卡诺图来处理化简过程-->



# 从逻辑到门

**电路原理图**描述了数字电路的内部元件及其相互连接

电路原理图需要遵循一致的风格：

- Inputs are on the left (or top) side of a schematic. 

- Outputs are on the right (or bottom) side of a schematic. 

- Whenever possible, gates should flow from left to right. 

- Straight wires are better to use than wires with multiple corners (jagged wires waste mental effort following the wire rather than thinking of what the circuit does). 

- Wires always connect at a T junction. 

- A dot where wires cross indicates a connection between the wires. 

- Wires crossing without a dot make no connection.

![image-20220612153734037](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121537099.png)



许多电路都有多个输出，

- 可以针对每一个输出分别计算输入的布尔函数
- 在一个真值表中写出所有输出，并画出具有所有输出的原理图                    

# 多级组合逻辑

## 减少硬件

![image-20220612155548705](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121555739.png)

好的多级组合电路使用的硬件比两极组合电路更少。



## 推气泡

CMOS电路中与非门和或非门更加常用，但是从仅包含与非门和或非门的电路中突出布尔表达式较为复杂，推气泡可以帮助重画电路，以便消除气泡并比较容易的确定逻辑功能。

- Begin at the output of the circuit and work toward the inputs. 
- Push any bubbles on the final output back toward the inputs so that you can read an equation in terms of the output (for example, Y) instead of the complement of the output $\bar Y$. 

- Working backward, draw each gate in a form so that bubbles cancel. If the current gate has an input bubble, draw the preceding gate with an output bubble. If the current gate does not have an input bubble, draw the preceding gate without an output bubble.

# X和Z

## 非法值X

符号X表示电路有未知或非法值

**这通常发生在此结点同时被0或者1驱动**

**竞争**——结点Y同时被高电平和低电平驱动

- 在竞争结点上的真实电压可能处于0-$V_{DD}$之间，取决于驱动高电平和低电平两个门的相对强度
- 经常、但不总是处于禁止区域
- 竞争还可能导致大电流在两个竞争的门之间流动，使得电路发热并可能被损坏

X值有时也被电路仿真器用来表示一个没有被初始化的值

当X出现在真值表中时，它表示不重要的值

## 浮空值

符号Z表示结点既没有被高电平驱动，也没有被低电平驱动

这种结点称为**浮空**（floating）、高阻态（high impedence）

一个浮空结点并不意味着电路出错，一旦其他电路元件将这个结点驱动到有效电平，这个结点上的值就可以参与电路操作。

![image-20220612162515547](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121625586.png)

三态缓冲器曾经用来实现共享总线。

但是现代计算机中需要点到点链路，此时芯片之间就是直接连接而不再通过共享的总线。

![image-20220612162732972](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121627026.png)





# 卡诺图

与真值表的每一行一样，卡诺图的每一个方格代表了一个最小项

![image-20220612164040062](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121641744.png)

每一个方格（或最小项）与相邻方格中有一个变量的值不同。

可以拿起图将其卷成一个圆柱体，连接圆柱体的末端形成一个圆环，仍然保证相邻方格只有一个变量不同。



## 画圈的原理

- 对于每一个圆圈可以写出对应的蕴含项
- 一个蕴含项是由一个或多个变量产生的
- 在同一个圈中同时包含了真值形式和取反形式的某个变量可以从蕴含项中删除



## 卡诺图化简逻辑

规则：

- 用尽可能少的圈来圈住卡诺图中所有为1的方格
- 每个圈中的所有方格必须都包含1
- 每个圈都必须是矩形，其每边长必须是2的整数次幂
- 每个圈必须尽可能的大
- 圈可以环绕卡诺图的边界
- 如果可以使用更少数量的圈，则卡诺图中一个为1的方格可以被多次圈住

<!--蒋氏算法画圈-->

1. 寻找一个未被圈包围的最小项
   1. 如果找不到，算法结束
   2. 如果找到了，则找到包含此最小项的最大矩形圈
2. 重复步骤1

## 无关项

在卡诺图中，无关项可以进一步帮助化简逻辑。

如果可以用较少或较大的圈覆盖1,则这些无关项可以被圈起来。

但如果它们没有帮助，也可以不圈起来。



# 组合逻辑模块

我们已经学习了三种组合逻辑模块

- 全加器
- 优先级电路
- 7段译码显示器

## 复用器

根据选择（select）信号的值从多个可能的输入中选择一个作为输出。复用器有时简称为mux。

### 2-1复用器

![image-20220612172255863](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121722906.png)

![image-20220612172429443](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121724485.png)

![image-20220612172438847](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121724883.png)

S是控制信号（control signal）



### 更宽的复用器

![image-20220612172657341](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121726373.png)

![image-20220612172636646](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121726692.png)

an N:1 multiplexer needs $log_2N$ select lines. 



## 复用器逻辑

![image-20220612173238773](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121732813.png)

 a $2^N$-input multiplexer can be programmed to perform any N-input logic function by applying 0’s and 1’s to the appropriate data inputs.

通过改变数据输入，复用器可以重新编程来实现其他功能。

我们能够将复用器的大小减小一般，只使用一个$2^{n-1}$输入复用器实现任何$N$输入逻辑函数。

![image-20220612173627919](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121736971.png)

![image-20220612173826713](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121738748.png)



## 译码器

输出称为one-hot

因为在给定时间恰好只有一个输出为高电平

![image-20220612173948220](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121739264.png)

**译码器逻辑**

译码器可以和或门组合来实现逻辑函数

译码器的每一个输出都代表一个最小项

函数将以所有最小项的或来实现

一个在真值表中包含M个1的N输入函数没可以通过一个$N:2^N$译码器和M输入或门来实现

![image-20220612174718213](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206121747251.png)



# 时序

电路设计中最具有挑战性的问题是**时序**：如何是电路运行的最快

输出响应输入需要一定的时间。

时序图（timing diagram）：描绘了当输入改变时电路的瞬间响应（transient response）

从低电平LOW到高电平HIGH的转变称为**上升沿**

从高电平HIGH到低电平LOW的转变称为**下降沿**

灰色箭头表示Y的上升沿由A的上升沿引起。

在输入信号A的50%点到输出信号50%点之间测量延迟。

![image-20220612212028991](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206122120035.png)



## 传播延迟和最小延迟

propagation delay——当输入改变直到一个或多个输出达到它们的最终值所经历的最长时间

contamination delay——当一个输入发生改变直到任何一个输出开始改变的最短时间

![image-20220612212644934](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206122126975.png)

组合电路的

- 传播延迟是关键路径上每一个元件的传播延迟之和
- 最小延迟是最短路径上每个元件的最小延迟之和

![image-20220612212849455](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206122128522.png)

control critical——关键路径是从控制信号S到输出Y

data critical_关键路径是从数据输入到输出

如果数据输入在控制输入前到达，则我们倾向于具有最短控制-输出延迟的设计；

如果控制信号在数据输入之前到达，则我们选择具有最短数据-输出延迟的设计

## 毛刺

一个输入信号的改变可能会导致多个输出信号的改变——glitch or hazard

![image-20220613083811299](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206130840297.png)

可能产生毛刺：卡诺图相切，信号的变化在卡诺图中穿越两个主蕴含项的边缘时，

产生原因：在另一个主蕴含项的电路开启前，如果主蕴含项的电路将关闭，就会产生毛刺。

去除毛刺：可以增加一个新的覆盖主蕴含项边缘的圈（一致项或冗余项）

![image-20220613084656473](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206130846532.png)

![image-20220613084710158](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206130847218.png)

![image-20220613084728883](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206130847926.png)

![image-20220613084831261](https://cdn.jsdelivr.net/gh/jdccccc/PictureBed/img/202206130848306.png)

<!--多个输入上的同时变化也会导致毛刺，这些毛刺不能通过增加硬件来避免-->
