---
title: 13.文件输入/输出
date: 2021-08-05 18:46:30
tags: C
---

# 13.文件输入/输出

## 文本模式和二进制模式

- 文本文件使用的二进制编码是ASCII或Unicode
- 二进制文件是除了文本文件之外的文件存储模式
- C访问文件的途径
    - 二进制模式
        - 程序可以访问文件的每个字节
    - 文本模式
        - 程序所见的内容和文件的实际内容不同，把本地环境表示的行末尾或文件结尾映射为C模式
        - 二进制模式读写文本文件，不会发生映射
- 标准文件
    - C程序会自动打开3个文件
        - 标准输入
        - 标准输出
        - 标准错误输出
    - 如果重定向把输出发送给文件而不是屏幕，那么发送至标准错误输出的内容仍然会被发送到屏幕上

## 标准I/O

### exit()函数

exit()函数关闭所有打开的文件并结束程序，exit()的参数被传递给一些操作系统

- EXIT_SUCCESS
- EXIT_FAILURE
- main() 中使用return 和调用exit()相同

### fopen()函数

- 第一个参数是待打开文件的名称（包含该文件名的字符串地址）
- 第二个参数是指定打开文件的模式的字符串
    - P417表13.1
- fopen()将返回文件指针

### getc()和putc()函数

- getc(fp)
- putc(ch,fpout)

功能和getchar、putchar相仿

### 文件结尾

getc在读到文件结尾的时候会返回一个EOF

### fclose()

fclose(fp)函数关闭fp指定的文件

- 成功返回0
- 否则返回EOF

### 指向标准文件的指针

- stdin
- stdout
- stderr

## 文件I/O

### fprintf()和fscanf()

两者类printf和scanf，区别在于前两者的第一个参数指定待处理的文件

rewind接受一个文件指针作为参数

### fgets()和fputs()

fgets(buf,STLEN,fp)

## 随机访问：fseek()和ftell()

- fseek()
    - 第一个参数时FILE指针，指向待查找的文件
    - 第二个参数是偏移量，必须是long类型的值
    - 第三个参数是起始点
    - 表13.3P424
    - 正常返回0
    - 错误返回-1
- ftell()
    - 返回类型为long，是参数指向文件当前位置距文件开始处的字节数

## fgetpos()和fsetpos()

P426

## 标准I/O的机理

## 其他标准I/O函数P427

- ungetc
- fflush
- setvbuf

### fwrite和fread

- fwrite(ptr,size,nmemb,fp)
    - 正常是nmemb
    - 错误小于nmemb
- fread(ptr,size,nmemb,fp)

### feof和ferror

